# Malware Incident Response Playbook

## 1. Overview
This playbook outlines the response procedures for malware incidents involving malicious code execution, persistence, or lateral movement within the environment.

## 2. Incident Scope
- Malware detected on endpoints or servers
- Suspicious processes or persistence mechanisms
- Ransomware or trojan activity

## 3. Detection
- Endpoint Detection and Response (EDR) alerts
- Antivirus or anti-malware detections
- SIEM alerts for suspicious process execution or network activity

### Malware Analysis (SOC Analyst Actions)
- Identify malware name, type, and detection source
- Review process execution and parent-child relationships
- Analyze file hashes and behavior using reputation services
- Review network connections for command-and-control (C2) activity
- Identify indicators of compromise (IOCs):
  - File hashes
  - IP addresses
  - Domains
  - Registry keys

## 4. Triage
- Validate malware detection
- Identify affected host(s) and user(s)
- Determine malware type (commodity, ransomware, targeted)
- Assess scope (single system vs multiple systems)
- Assign severity level (Low / Medium / High)
  - Low: Malware blocked, no execution
  - Medium: Malware executed on a single host
  - High: Lateral movement, ransomware, or critical systems affected
- Decide escalation path

## 5. Malware Investigation Checklist

### Host Analysis
- [ ] Identify affected endpoints or servers
- [ ] Capture malware file and hash values
- [ ] Review running processes and persistence mechanisms
- [ ] Check scheduled tasks, registry keys, or startup items

### Network Activity
- [ ] Identify outbound connections to suspicious IPs/domains
- [ ] Check for C2 communication
- [ ] Review proxy and firewall logs

### Scope and Impact
- [ ] Determine number of infected systems
- [ ] Identify affected user accounts
- [ ] Assess business impact

### Severity and Escalation
- [ ] Assign severity level
- [ ] Determine need for system isolation
- [ ] Decide if escalation is required

## 6. Containment
- Isolate infected systems from the network
- Block malicious IPs, domains, and hashes
- Disable affected user accounts if credential theft is suspected
- Prevent further malware execution via endpoint controls

## 7. Eradication & Recovery
- Remove malware using EDR or antivirus tools
- Reimage systems if required
- Apply security patches and updates
- Restore systems from known-good backups
- Monitor systems for reinfection

## 8. Post-Incident Actions
- Conduct root cause analysis
- Update malware detection and SIEM rules
- Improve endpoint hardening and security controls
- Document incident details and lessons learned

## 9. Escalation Criteria
- Ransomware detected
- Malware spreading laterally
- Critical infrastructure or servers affected
- Evidence of data exfiltration

## 10. MITRE ATT&CK Mapping
- T1059: Command and Scripting Interpreter
- T1105: Ingress Tool Transfer
- T1027: Obfuscated Files or Information
- T1486: Data Encrypted for Impact

