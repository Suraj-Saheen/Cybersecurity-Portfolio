# Behavior Analysis – Sample 3

## File Information
- **File Name:** opszx.scr.exe
- **File Type:** PE32 executable
- **SHA256:** 481fe3840d515d4d19d6fb16143aa6845b9df798fe8d6c843297d34219cb14d0

## Detection Summary
- 59 / 71 security vendors flagged this file as malicious
- **Malware Type:** trojan
- **Malware Family:** msil / formbook / inject5


## Static Analysis
- File type and metadata:
  - PE executable (MSIL / .NET)
  - Contains assembly metadata, possibly obfuscated
- Anti-analysis features:
  - Detects debug environments
  - Uses long sleeps to evade sandbox analysis
- Capabilities inferred:
  - Reads user input (likely for credential capture)
  - Spreader functionality hints at propagation mechanisms
- Embedded resources / files:
  - Bundled XML files
  - Dropped ICO / script files (e.g., counters.dat, app.exe.log)

**Conclusion:** The executable is a trojan capable of network communication, file dropping, and potentially credential harvesting. Obfuscation and sandbox evasion features suggest it’s designed to avoid automated detection.

## Dynamic Analysis (Sandbox)
- Execution initiated via communication with low-reputation domains, likely C2 servers (terelprime.com)
- Remote document fetched from external server
- Secondary payload downloaded and executed
- Dropped multiple files including executable payloads
- Captures user input (keylogging / credential harvesting inferred)
- Likely injects into other processes for persistence

**Conclusion:** Dynamic analysis confirms this is a multi-stage trojan. It connects to external servers, drops additional payloads, and likely exfiltrates user data (credentials). Sandbox evasion features reduce observable actions unless run in a fully instrumented environment.

## Dropped Malicious Files
- app.exe.log
- counters.dat


## MITRE ATT&CK – Key Techniques Observed

Only techniques directly supported by sandbox behavior and known FormBook functionality are included. Generic sandbox-inferred noise has been excluded for clarity.

- **T1106 – Native API** 
  - Uses Windows native APIs for execution and system-level interaction.

- **T1574 – Hijack Execution Flow** 
  - Abuses execution flow mechanisms to establish persistence and load malicious code.

- **T1027 – Obfuscated Files or Information** 
  - Obfuscates payloads and strings to hinder static analysis.

- **T1045 – Software Packing**
  - Executable is packed to evade detection and delay reverse engineering.

- **T1497 – Virtualization / Sandbox Evasion** 
  - Detects virtualized or sandbox environments and alters behavior accordingly.

- **T1620 – Reflective Code Loading**
  - Loads malicious code directly into memory without writing files to disk.

- **T1056 – Input Capture**
  - Captures keystrokes and user input to steal credentials.

- **T1003 – OS Credential Dumping** 
  - Attempts to access stored operating system credentials.

- **T1082 – System Information Discovery** 
  - Collects system and environment information from the infected host.

- **T1057 – Process Discovery** 
  - Enumerates running processes to identify targets for injection.

- **T1115 – Clipboard Data** 
  - Monitors clipboard contents for sensitive information.

- **T1119 – Automated Collection** 
  - Automatically gathers stolen data prior to exfiltration.

- **T1071 – Application Layer Protocol** 
  - Communicates with command-and-control infrastructure over HTTP/HTTPS.

  
  

