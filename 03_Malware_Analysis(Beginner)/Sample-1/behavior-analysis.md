# Behavior Analysis – Sample 1

## File Information
- **File Name:** BankPaymAdviceVend.Report.docx
- **File Type:** Microsoft Word Document (DOCX)
- **SHA256:** 2e1408013503cbc13466e2041bd3e045833ce65f5c91b7226e28e27d43d6eaf9

## Detection Summary
- 39 / 65 security vendors flagged this file as malicious
- **Malware Type:** Trojan Downloader
- **Exploit Used:** CVE-2017-0199
- **Malware Family:** W97M / AHFU / DocDL


## Static Analysis
- File Entropy = 7.977780 bits per byte.
- No readable URLs, IP addresses, or domains found using `strings` and `grep`
- This is expected behavior for CVE-2017-0199 exploits
- Malicious content is triggered via external OLE object at runtime

## Dynamic Analysis (Sandbox)
- Execution initiated via WINWORD.EXE
- External OLE object loaded
- Remote document fetched from external server
- Secondary payload downloaded and executed
- Dropped multiple files including executable payloads

## Dropped Malicious Files
- ESUuQ.exe (Win32 Executable)
- microsoftballondesignedbyentireprocesstoconfirmtheupdationtodevelopnewballonupdationrpcesstopcupdatepc.doc
- Total 83 files are dropped which is not possible to list them all here, check virutotal website with the sha256 hash value to get all the details.

## MITRE ATT&CK – Key Techniques Observed

The following ATT&CK techniques were selected based on direct observation and relevance to the malware’s behavior. Sandbox-inferred noise was intentionally excluded for clarity.

- **T1203 – Exploitation for Client Execution**
  - Document exploits CVE-2017-0199 to execute code on open.
- **T1221 – Template Injection**
  - External template used to retrieve malicious content.
- **T1053 – Scheduled Task/Job**
  - Indicates potential persistence mechanism.
- **T1071 – Application Layer Protocol**
  - Command-and-control traffic over HTTP/HTTPS.
- **T1032 – Encrypted Channel**
  - Encrypted C2 communications observed.
- **T1056 – Input Capture**
  - Behavior consistent with information harvesting.
- **T1082 – System Information Discovery**
  - System profiling conducted post-execution.
  
## MITRE ATT&CK Coverage
This malware exhibits techniques across multiple ATT&CK tactics including Execution, Persistence, Defense Evasion, Credential Access, Collection, and Command and Control, indicating a multi-stage threat capable of data exfiltration and long-term access.

